import{d as S,a as _,r as p,q as R,aj as C,_ as b,h as d,o as y,i as $,j as P,w as G,f as u,e as c,O as T,P as N,p as M,b as E,ak as A,ac as B,ad as F,c as D,G as H,W as Q,E as U,K as W,J as j}from"./index-TJS2hmaO.js";import{a as k}from"./GInfoModal.vue_vue_type_style_index_0_scoped_7dbd3e8b_lang-ad--gqas.js";import{G as Y}from"./GInfoModal-XtlQK8oU.js";import{L as Z}from"./LandingPageView-4HUhhgYX.js";import{r as h,t as L,Z as J}from"./uds-UowGIRPf.js";import{G as z}from"./GInput-7N3XVSRP.js";import{u as I,a as K}from"./use-http-error-ur1RkNm8.js";import{u as O,V as v}from"./use-validation-6mrSBghf.js";import"./GButton-matszJm_.js";import"./GLoadingSpinner-UW9luGs8.js";const X=S({name:"ForgotPasswordModal",owner:_.Teams.C3PLS,components:{GModal:k,UdsButton:h,GInput:z},props:{email:String},emits:["onSuccess"],setup(o,{emit:e}){const s=p(!1),n=p(!1),t=p(o.email||""),r=O([{name:"email",value:t,validations:[{type:v.REQUIRED},{type:v.EMAIL}]}],n),l=I(),a=async()=>{if(n.value=!0,!!r.value.isValid){s.value=!0;try{await C.forgotPassword(t.value),e("onSuccess")}catch(i){throw l.display({message:"Unable to request password update.",error:i}),i}finally{s.value=!1}}};return R(()=>o.email,i=>{i&&(t.value=i)}),{localEmail:t,isLoading:s,validation:r,submitted:n,onSubmit:a,ButtonSize:L}}}),x=o=>(M("data-v-d1fa8e53"),o=o(),E(),o),oo=x(()=>c("div",{class:"form__top-box"},[c("h2",{class:"form__title"},"Forgot password?"),c("p",{class:"form__subtitle"}," To keep your account safe, we will send you an email with a link to set a new password. ")],-1));function eo(o,e,s,n,t,r){const l=d("GInput"),a=d("UdsButton"),i=d("GModal");return y(),$(i,T(N(o.$attrs)),{body:P(()=>{var w,f;return[c("form",{name:"forgot-password",class:"forgot-password form",novalidate:"",onSubmit:e[1]||(e[1]=G((...m)=>o.onSubmit&&o.onSubmit(...m),["prevent"]))},[oo,c("div",null,[u(l,{modelValue:o.localEmail,"onUpdate:modelValue":e[0]||(e[0]=m=>o.localEmail=m),required:"",name:"email",type:"text",label:"Email",error:(f=(w=o.validation.errors.email)==null?void 0:w[0])==null?void 0:f.message,placeholder:"user@email.com"},null,8,["modelValue","error"])]),u(a,{name:"submit",label:"Send",block:"",size:o.ButtonSize.large,loading:o.isLoading,class:"form__button","track-action-name":"account.forgot_password.submit"},null,8,["size","loading"])],32)]}),_:1},16)}const so=b(X,[["render",eo],["__scopeId","data-v-d1fa8e53"]]),ao={email:[{type:v.REQUIRED},{type:v.EMAIL}],password:[{type:v.REQUIRED},{type:v.MIN_LENGTH,value:3}]},V=ao,no=S({name:"LoginForm",owner:_.Teams.C3PLS,components:{GInput:z,UdsButton:h},emits:["onForgotPassword","onPasswordExpired"],setup(o,{emit:e}){const s=p(""),n=p(""),t=p(!1),r=p(!1),l=K(),a=O([{name:"email",value:s,validations:V.email},{name:"password",value:n,validations:V.password}],t),i=I();return{email:s,password:n,isLoading:r,validation:a,submitted:t,onForgotPassword:()=>e("onForgotPassword",s.value),onSubmit:async()=>{if(t.value=!0,!!a.value.isValid){r.value=!0;try{await A(s.value,n.value)}catch(m){if(B(m,F.UNAUTHORIZED)){l.emit({type:"error",title:"Login failed",message:"Incorrect email or password"});return}if(B(m,F.EXPIRED_PASSWORD)){e("onPasswordExpired",s.value);return}throw i.display({message:"Unable to login.",error:m}),m}finally{r.value=!1}}},ButtonSize:L,ButtonVariants:J}}}),to=o=>(M("data-v-83741453"),o=o(),E(),o),ro=to(()=>c("div",{class:"form__top-box"},[c("h2",{class:"login-form__title"},"Welcome back!")],-1)),lo={class:"login-form__forgot"};function io(o,e,s,n,t,r){var i,w,f,m;const l=d("GInput"),a=d("UdsButton");return y(),D("form",{name:"login",class:"form login-form",novalidate:"",onSubmit:e[2]||(e[2]=G((...g)=>o.onSubmit&&o.onSubmit(...g),["prevent"]))},[ro,c("div",null,[u(l,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=g=>o.email=g),required:"",name:"email",class:"form__input",type:"text",label:"Email",error:(w=(i=o.validation.errors.email)==null?void 0:i[0])==null?void 0:w.message,placeholder:"user@email.com"},null,8,["modelValue","error"]),u(l,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=g=>o.password=g),required:"",class:"form__input",name:"password",type:"password",label:"Password",error:(m=(f=o.validation.errors.password)==null?void 0:f[0])==null?void 0:m.message,placeholder:"Password"},null,8,["modelValue","error"])]),c("div",lo,[u(a,{variant:o.ButtonVariants.floating,type:"button",label:"Forgot password?","track-action-name":"account.forgot_password.open",onClick:o.onForgotPassword},null,8,["variant","onClick"])]),u(a,{name:"submit",label:"Log in",size:o.ButtonSize.large,class:"form__button",block:"","track-action-name":"account.login.submit",loading:o.isLoading},null,8,["size","loading"])],32)}const uo=b(no,[["render",io],["__scopeId","data-v-83741453"]]),mo=S({name:"PasswordExpiredModal",owner:_.Teams.C3PLS,components:{GModal:k,UdsButton:h,GIcon:H},props:{email:{type:String}},emits:["onSuccess"],setup(o,{emit:e}){const s=p(!1),n=I();return{isLoading:s,requestNewPassword:async()=>{if(o.email){s.value=!0;try{await C.forgotPassword(o.email),e("onSuccess")}catch(r){throw n.display({message:"Unable to request password update.",error:r}),r}finally{s.value=!1}}},ButtonSize:L}}}),q=o=>(M("data-v-df838984"),o=o(),E(),o),po=q(()=>c("h2",{class:"expired-modal__title"},"Your password has expired",-1)),co=q(()=>c("p",{class:"expired-modal__subtitle"}," Your account credentials have expired. Click on the button to request a new password and we will send you an email to complete next steps. ",-1));function wo(o,e,s,n,t,r){const l=d("GIcon"),a=d("UdsButton"),i=d("GModal");return y(),$(i,Q({class:"expired-modal"},o.$attrs),{header:P(()=>[u(l,{size:"l",name:"alert"}),po]),body:P(()=>[co,u(a,{label:"Set new password",block:"",size:o.ButtonSize.medium,loading:o.isLoading,class:"expired-modal__button","track-action-name":"account.login.request_password.submit",onClick:o.requestNewPassword},null,8,["size","loading","onClick"])]),_:1},16)}const fo=b(mo,[["render",wo],["__scopeId","data-v-df838984"]]),go=S({name:"LoginView",owner:_.Teams.C3PLS,components:{ForgotPasswordModal:so,GInfoModal:Y,PasswordExpiredModal:fo,LandingPageView:Z,LoginForm:uo,FeatureBoundary:U.FeatureBoundary},setup(){const o=p(),e=p(!1),s=p(!1),n=p(!1),t=a=>{o.value=a,e.value=!0},r=a=>{o.value=a,s.value=!0},l=()=>{n.value=!0,e.value=!1,s.value=!1};return{team:_.Teams.C3PLS,email:o,showForgotPasswordModal:e,showExpiredPasswordModal:s,showInfoModal:n,openForgotPasswordModal:t,openExpiredPasswordModal:r,onSuccessModal:l}}});function _o(o,e,s,n,t,r){const l=d("LoginForm"),a=d("ForgotPasswordModal"),i=d("FeatureBoundary"),w=d("PasswordExpiredModal"),f=d("GInfoModal"),m=d("LandingPageView");return y(),$(m,null,{default:P(()=>[u(l,{onOnForgotPassword:o.openForgotPasswordModal,onOnPasswordExpired:o.openExpiredPasswordModal},null,8,["onOnForgotPassword","onOnPasswordExpired"]),u(i,{id:"account.forgot_password",owner:o.team},{default:P(()=>[u(a,{email:o.email,"is-open":o.showForgotPasswordModal,onOnSuccess:o.onSuccessModal,onOnClose:e[0]||(e[0]=g=>o.showForgotPasswordModal=!1)},null,8,["email","is-open","onOnSuccess"])]),_:1},8,["owner"]),u(w,{email:o.email,"is-open":o.showExpiredPasswordModal,onOnSuccess:o.onSuccessModal,onOnClose:e[1]||(e[1]=g=>o.showExpiredPasswordModal=!1)},null,8,["email","is-open","onOnSuccess"]),u(f,{type:"success",title:"Password reset requested",message:"Please review your inbox,</br> you will receive an email if the account exists.","is-open":o.showInfoModal,onOnClose:e[2]||(e[2]=g=>o.showInfoModal=!1)},null,8,["is-open"])]),_:1})}const vo=b(go,[["render",_o]]),Po=S({name:"LoginViewRoot",owner:_.Teams.C3PLS,components:{FeatureBoundary:U.FeatureBoundary,LoginView:vo},setup(){return W(()=>{j("account.login.render",{})}),{team:_.Teams.C3PLS}}});function So(o,e,s,n,t,r){const l=d("LoginView"),a=d("FeatureBoundary");return y(),$(a,{id:"account.login",owner:o.team},{default:P(()=>[u(l)]),_:1},8,["owner"])}const Vo=b(Po,[["render",So]]);export{Vo as default};
